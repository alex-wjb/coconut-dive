<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
  </head>
  <body>
    <canvas id="canvas" />
    <img class="sprite" id="coco1" src="./sprites/coconut1.png" />
    <img class="sprite" id="seaTile" src="./sprites/SeaTile.png" />

    <style>
      html,
      body {
        margin: 0;
        padding: 0;
        background: black;
      }

      canvas {
        background: grey;
        /* height: 100%;
        width: 100%; */
        height: 100vh;
        display: block;
        margin-inline: auto;
      }

      .sprite {
        display: none;
      }
    </style>
    <script type="module">
      import { Game } from "/game.js";

      const drawBackground = (canvas, tileNum) => {
        const ctx = canvas.getContext("2d");
        const seaTile = document.getElementById("seaTile");
        canvas.width = seaTile.width * tileNum;
        canvas.height = window.innerHeight;
        let tileRowWidth = 0; 
        let tileColHeight = 0;

        const pattern = ctx.createPattern(seaTile, "repeat");
        ctx.fillStyle = pattern;
        ctx.fillRect(0, 0, canvas.width, canvas.height);
      };

      window.addEventListener("load", () => {
        //setup canvas
        const canvas = document.getElementById("canvas");
        const ctx = canvas.getContext("2d");
        //TODO: may only need to set in css

        // ctx.drawImage(document.getElementById("ocean"), 0, 0);
        drawBackground(canvas, 10);

        //create game object
        const game = new Game(canvas);

        //set initial animation time stamp
        let lastTime = 0;
        //recursive animation function
        function animate(timeStamp) {
          //calculate time between calls of animate (ms)

          const deltaAnimateTime = timeStamp - lastTime;
          lastTime = timeStamp;
        
          game.render(ctx, deltaAnimateTime);
          
          //creates endless animation loop due to recursion
          //requestAnimationFrame automatically adjusts itself to screen refresh rate
          //passes a timestamp parameter into the function it calls each time it is executed.
          window.requestAnimationFrame(animate);
        }
        //begin game animation loop
        animate(0);
      });
    </script>
  </body>
</html>
